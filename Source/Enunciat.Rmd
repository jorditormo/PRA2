---
title: "PRA 2 - Com realitzar la neteja i l'anàlisi de dades?"
author: "Judith Cid, Jordi Tormo"
date: "2023-12-27"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_libraries, include=FALSE}
library(knitr)
```

# 1. Descripció del dataset. 

Perquè és important i quina pregunta/problema pretén respondre?

El conjunt de dades “Heart Attack Analysis & Prediction dataset” s'ha obtingut de l'enllaç proporcionat a l'enunciat (https://www.kaggle.com/datasets/rashikrahmanpritom/heart-attackanalysis-prediction-dataset). Dels dos documents disponibles a l'enllaç, es treballarà amb el document `heart.csv`.

* `age`: Edat del pacient
* `sex`: Sexe del pacient
* `cp` : Tipus de dolor toràcic.
  * `1`: Angina de pit típica
  * `2`: Angina de pit atípica
  * `3`: Dolor no anginal
  * `4`: Asimptomàtic
* `trtbps`: Pressió arterial en repòs (in mm Hg)
* `chol`: Colesterol en mg/dl obtingut mitjançant sensor d'IMC (índex de massa corporal)
* `fbs`: Sucre en sang en dejú > 120 mg/dl
  * `1`: Vertader
  * `0`: Fals
* `restecg`: Resultats electrocardiogràfics en repòs
  * `0`: Normal
  * `1`: Té anomalia de l'ona ST-T (inversions d'ona T i/o elevació o depressió ST de > 0,05 mV)
  * `2`: Mostra una hipertròfia ventricular esquerra probable o definitiva segons el criteri d'Estes
* `thalachh`: Freqüència cardíaca màxima aconseguida
* `exng`: Exercici angina de pit induïda
  * `1`: Sí
  * `0`: No
* `oldpeak`:  Depressió de ST induïda per l'exercici en relació amb el descans
* `slp`: El pendent del segment ST d'exercici màxim
  * `0`: Sense inclinar
  * `1`: Pla
  * `2`: Baixada
* `caa`: Nombre de vasos principals del cor (0-3)
* `thall`: Talassèmia
  * `0`: Nul
  * `1`: Defecte solucionat 
  * `2`: Normal 
  * `3`: Defecte reversible
* `output`: Diagnòstic de malalties cardíaques (estat de malaltia angiogràfica)
  * `0`: Estrenyiment < 50% del diàmetre. Menys possibilitats de patir malalties del cor.
  * `1`: Estrenyiment > 50% del diàmetre. Més possibilitats de patir malalties del cor.

# 2. Integració i selecció.

Integració i selecció de les dades d’interès a analitzar. Pot ser el resultat d’addicionar diferents datasets o una subselecció útil de les dades originals, en base a l’objectiu que es vulgui aconseguir.

S'utilitza el document `heart.csv` que consta de 303 registres i 14 atributs

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Es carrega el fitxer de dades en un objecte amb identificador denominat data
data <- read.csv('../Dataset/heart.csv',header=T,sep=",")

# s'examinen els valors resum de cada tipus de variable
str(data)
```
```{r echo=TRUE, message=FALSE, warning=FALSE}
# Pot ser interessant discretitzar les variables age
data["segment_age"] <- cut(data$age, breaks = c(0,25,35,45,55,65,100), labels = c("<25", "25-34", "35-44", "45-54","55-64",">65"))
plot(data$segment_age)
```


# 3. Neteja de les dades.

* **3.1. Les dades contenen zeros o elements buits? Gestiona cadascun d’aquests casos.**
```{r echo=TRUE, message=FALSE, warning=FALSE}



cat("\"Tipus de dolor toràcic\" (cp): \n")
cat("\t ·El número de zeros a l'atribut cp és:", nrow(data[data$cp == 0, ]) ,".\n")
cat("\t ·A part dels valors possibles (1,2,3 i 4) i elemens buits, hi ha", sum(data$cp %in% c(0,1,2,3,4)) - nrow(data) ,"resistres amb altres valors.\n")
data[data$cp == 0,]$cp <- NA
cat("\t ·Els zeros s'han sobreescrit com valors na.\n")

cat("\"Pressió arterial en repòs (in mm Hg)\" (trtbps): \n")
if(nrow(data[data$trtbps == 0, ]) == 0){
  cat("\t ·No hi ha zeros a l'atribut trtbps.\n")
} else {
  data[data$trtbps == 0,]$trtbps <- NA
  cat("\t · S'han trobat", sum(is.na(data$trtbps)) , "zeros i s'han sobreescrit com valors na.\n")
}
if(nrow(data[data$trtbps < 0, ]) == 0) {
  cat("\t ·No hi ha valors negatius a l'atribut trtbps.\n")
} else {
  data[data$trtbps < 0,]$trtbps <- NA
  cat("\t ·Els valors negatius no són vàlids i s'han sobreescrit com a valros na.\n")
}
if (all.equal(data$trtbps, as.integer(data$trtbps)) ){
  cat("\t ·Tots els valors són enters.\n")
} else {
  data[data$trtbps,]$trtbps = as.integer(data[data$trtbps,])
  cat("\t ·S'han trobat valors positius no enters i s'han sobreescrit per valors enters.\n")
}


```

```{r echo=TRUE, message=FALSE, warning=FALSE}
sum(data$cp %in% c(0,1,2,3,4))
check_data
data$cp
```

* **3.2. Identifica i gestiona els valors extrems.**

# 4. Anàlisi de les dades.

* **4.1. Selecció dels grups de dades que es volen analitzar/comparar (p. e., si es volen comparar grups de dades, quins són aquests grups i quins tipus d’anàlisi s’aplicaran?).**

* **4.2. Comprovació de la normalitat i homogeneïtat de la variància.**

* **4.3. Aplicació de proves estadístiques per comparar els grups de dades. En funció de les dades i de l’objectiu de l’estudi, aplicar proves de contrast d’hipòtesis, correlacions, regressions, etc. Aplicar almenys tres mètodes d’anàlisi diferents.**

# 5. Representació dels resultats a partir de taules i gràfiques. 

Aquest apartat es pot respondre al llarg de la pràctica, sense la necessitat de concentrar totes les representacions en aquest punt de la pràctica. 

# 6. Resolució del problema. 

A partir dels resultats obtinguts, quines són les conclusions? Els resultats permeten respondre al problema?

# 7. Codi. 

Cal adjuntar el codi, preferiblement en R, amb el que s’ha realitzat la neteja, anàlisi i representació de les dades. Si ho preferiu, també podeu treballar en Python.

# 8. Vídeo. 

Realitzar un breu vídeo explicatiu de la pràctica (màxim 10 minuts) on tots els integrants de l'equip expliquin amb les seves pròpies paraules el desenvolupament de la pràctica, basant-se en les preguntes de l'enunciat per a justificar i explicar el codi desenvolupat. Aquest vídeo s'haurà de lliurar a través d'un enllaç al Google Drive de la UOC (https://drive.google.com/…), juntament
amb l’enllaç al repositori Git lliurat.



